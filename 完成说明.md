# Bangumi.NET é¡¹ç›®å®Œæˆè¯´æ˜

## é¡¹ç›®çŠ¶æ€ï¼šâœ… å·²å®Œæˆ

æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ Bangumi API .NET å®¢æˆ·ç«¯ç±»åº“ã€‚

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### æ ¸å¿ƒåº“æ–‡ä»¶ (Bangumi.NET é¡¹ç›®)

1. **BangumiClient.cs** - ä¸»å®¢æˆ·ç«¯ç±»ï¼ŒåŒ…å«æ‰€æœ‰ API æ–¹æ³•ï¼ˆ27ä¸ªæ–¹æ³•ï¼‰
2. **Common.cs** - é€šç”¨æ¨¡å‹å’Œæšä¸¾å®šä¹‰
3. **Subject.cs** - æ¡ç›®ç›¸å…³çš„æ¨¡å‹ç±»
4. **Episode.cs** - å‰§é›†ç›¸å…³çš„æ¨¡å‹ç±»
5. **Character.cs** - è§’è‰²ç›¸å…³çš„æ¨¡å‹ç±»
6. **Person.cs** - äººç‰©ç›¸å…³çš„æ¨¡å‹ç±»
7. **User.cs** - ç”¨æˆ·ç›¸å…³çš„æ¨¡å‹ç±»
8. **Collection.cs** - æ”¶è—ç›¸å…³çš„æ¨¡å‹ç±»
9. **Calendar.cs** - æ¯æ—¥æ”¾é€ç›¸å…³çš„æ¨¡å‹ç±»
10. **Bangumi.NET.csproj** - é¡¹ç›®é…ç½®æ–‡ä»¶ï¼ˆå·²æ·»åŠ  System.Text.Json ä¾èµ–ï¼‰

### ç¤ºä¾‹é¡¹ç›® (Bangumi.NET.Example é¡¹ç›®)

1. **Program.cs** - å®Œæ•´çš„ç¤ºä¾‹ç¨‹åºï¼Œæ¼”ç¤ºæ‰€æœ‰ä¸»è¦åŠŸèƒ½
2. **Bangumi.NET.Example.csproj** - ç¤ºä¾‹é¡¹ç›®é…ç½®ï¼ˆå·²æ·»åŠ å¯¹ä¸»åº“çš„å¼•ç”¨ï¼‰

### æ–‡æ¡£æ–‡ä»¶

1. **README.md** - å®Œæ•´çš„é¡¹ç›®æ–‡æ¡£ï¼ŒåŒ…å«æ‰€æœ‰ API çš„è¯¦ç»†è¯´æ˜
2. **QUICKSTART.md** - 5åˆ†é’Ÿå¿«é€Ÿå…¥é—¨æŒ‡å—
3. **EXAMPLES.md** - è¯¦ç»†çš„ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ…å«å„ç§åœºæ™¯çš„ç¤ºä¾‹ä»£ç 
4. **BUILD_AND_TEST.md** - æ„å»ºå’Œæµ‹è¯•æŒ‡å—ï¼ŒåŒ…å«æ•…éšœæ’é™¤
5. **PROJECT_SUMMARY.md** - é¡¹ç›®æ€»ç»“ï¼ŒåŒ…å«æŠ€æœ¯å®ç°è¦ç‚¹
6. **VERIFICATION.md** - å®Œæ•´çš„éªŒè¯æ¸…å•ï¼Œå¸®åŠ©æ‚¨æµ‹è¯•é¡¹ç›®
7. **å®Œæˆè¯´æ˜.md** - æœ¬æ–‡æ¡£

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### å®Œæ•´çš„ API æ”¯æŒï¼ˆ100% è¦†ç›–ï¼‰

| æ¨¡å— | åŠŸèƒ½ | æ–¹æ³•æ•° |
|------|------|--------|
| æ¡ç›® (Subject) | æœç´¢ã€è·å–è¯¦æƒ…ã€æ‰¹é‡è·å–ã€å…³è”æŸ¥è¯¢ | 6 |
| å‰§é›† (Episode) | åˆ—è¡¨æŸ¥è¯¢ã€è¯¦æƒ…è·å– | 2 |
| è§’è‰² (Character) | æœç´¢ã€è¯¦æƒ…ã€å…³è”æŸ¥è¯¢ | 4 |
| äººç‰© (Person) | æœç´¢ã€è¯¦æƒ…ã€å…³è”æŸ¥è¯¢ | 4 |
| ç”¨æˆ· (User) | è·å–ä¿¡æ¯ | 2 |
| æ”¶è— (Collection) | å¢åˆ æ”¹æŸ¥ã€ç« èŠ‚ç®¡ç† | 8 |
| æ¯æ—¥æ”¾é€ (Calendar) | è·å–æ”¾é€ä¿¡æ¯ | 1 |
| **æ€»è®¡** | | **27** |

### æŠ€æœ¯ç‰¹æ€§

- âœ… å¼ºç±»å‹æ¨¡å‹å®šä¹‰
- âœ… å®Œæ•´çš„æšä¸¾æ”¯æŒ
- âœ… å¼‚æ­¥/ç­‰å¾…æ¨¡å¼
- âœ… CancellationToken æ”¯æŒ
- âœ… è‡ªåŠ¨ HTTP å¤´ç®¡ç†
- âœ… JSON è‡ªåŠ¨åºåˆ—åŒ–/ååºåˆ—åŒ–
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶
- âœ… èµ„æºè‡ªåŠ¨é‡Šæ”¾ï¼ˆIDisposableï¼‰

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ–¹æ³• 1: ç›´æ¥è¿è¡Œç¤ºä¾‹ç¨‹åº

```bash
cd D:\code\Csharp\Bangumi.NET

# ç¡®ä¿ key.txt åŒ…å«æœ‰æ•ˆçš„ API Key
# å¦‚æœæ²¡æœ‰ï¼Œè¯·è®¿é—® https://next.bgm.tv/demo/access-token è·å–

# è¿è¡Œç¤ºä¾‹
cd Bangumi.NET.Example
dotnet run
```

### æ–¹æ³• 2: åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨

```csharp
using Bangumi.NET;
using Bangumi.NET.Models;

// 1. åˆ›å»ºå®¢æˆ·ç«¯
var apiKey = "your-api-key";
var userAgent = "MyApp/1.0 (https://mywebsite.com)";
using var client = new BangumiClient(apiKey, userAgent);

// 2. è°ƒç”¨ API
var me = await client.GetMyselfAsync();
Console.WriteLine($"æ¬¢è¿, {me?.Nickname}!");

// 3. æœç´¢æ¡ç›®
var request = new SubjectSearchRequest { Keyword = "CLANNAD" };
var result = await client.SearchSubjectsAsync(request);

// 4. è·å–è¯¦æƒ…
var subject = await client.GetSubjectByIdAsync(2097);
```

## ğŸ“– æ–‡æ¡£å¯¼èˆª

**æ–°æ‰‹å…¥é—¨**ï¼š
1. å…ˆçœ‹ `QUICKSTART.md` - 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
2. å†çœ‹ `README.md` - äº†è§£å®Œæ•´åŠŸèƒ½
3. å‚è€ƒ `EXAMPLES.md` - å­¦ä¹ å„ç§ç”¨æ³•

**å¼€å‘è€…**ï¼š
1. æŸ¥çœ‹ `README.md` çš„ API æ–‡æ¡£éƒ¨åˆ†
2. å‚è€ƒ `Bangumi.NET.Example/Program.cs` ç¤ºä¾‹ä»£ç 
3. ä½¿ç”¨ `EXAMPLES.md` ä¸­çš„ä»£ç ç‰‡æ®µ

**æµ‹è¯•éªŒè¯**ï¼š
1. æŒ‰ç…§ `BUILD_AND_TEST.md` æ„å»ºé¡¹ç›®
2. ä½¿ç”¨ `VERIFICATION.md` éªŒè¯æ‰€æœ‰åŠŸèƒ½
3. è¿è¡Œç¤ºä¾‹ç¨‹åºç¡®ä¿æ­£å¸¸å·¥ä½œ

## âœ… éªŒè¯æ­¥éª¤

ç”±äºç³»ç»Ÿç¯å¢ƒé™åˆ¶ï¼Œæˆ‘æ— æ³•ç›´æ¥è¿è¡Œæ„å»ºå‘½ä»¤ã€‚è¯·æ‚¨æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤éªŒè¯ï¼š

### ç¬¬ 1 æ­¥ï¼šæ„å»ºé¡¹ç›®

```bash
cd D:\code\Csharp\Bangumi.NET
dotnet restore
dotnet build
```

åº”è¯¥çœ‹åˆ°ï¼š
```
Build succeeded.
    0 Warning(s)
    0 Error(s)
```

### ç¬¬ 2 æ­¥ï¼šè¿è¡Œç¤ºä¾‹

```bash
cd Bangumi.NET.Example
dotnet run
```

åº”è¯¥çœ‹åˆ°ç¨‹åºè¾“å‡º 10 ä¸ªæµ‹è¯•åœºæ™¯çš„ç»“æœï¼Œæœ€åæ˜¾ç¤ºï¼š
```
=== æ‰€æœ‰æµ‹è¯•å®Œæˆ ===
```

### ç¬¬ 3 æ­¥ï¼šæ£€æŸ¥ç»“æœ

éªŒè¯ä»¥ä¸‹å†…å®¹ï¼š
- âœ… èƒ½è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- âœ… èƒ½æœç´¢æ¡ç›®
- âœ… èƒ½è·å–æ¡ç›®è¯¦æƒ…
- âœ… èƒ½è·å–è§’è‰²å’Œäººç‰©ä¿¡æ¯
- âœ… èƒ½è·å–æ¯æ—¥æ”¾é€
- âœ… æ‰€æœ‰ API è°ƒç”¨éƒ½è¿”å›æ­£ç¡®æ•°æ®

## ğŸ› å¯èƒ½é‡åˆ°çš„é—®é¢˜

### é—®é¢˜ 1: æ„å»ºå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ .NET ç‰ˆæœ¬
dotnet --version

# æ¸…ç†å¹¶é‡æ–°æ„å»º
dotnet clean
dotnet restore
dotnet build
```

### é—®é¢˜ 2: API 401 é”™è¯¯

**åŸå› **ï¼šAPI Key æ— æ•ˆæˆ–è¿‡æœŸ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. è®¿é—® https://next.bgm.tv/demo/access-token
2. é‡æ–°ç”Ÿæˆ Access Token
3. æ›´æ–° `key.txt` æ–‡ä»¶

### é—®é¢˜ 3: API 403 é”™è¯¯

**åŸå› **ï¼šUser-Agent ä¸ç¬¦åˆè¦æ±‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ `Bangumi.NET.Example/Program.cs` ç¬¬ 14 è¡Œï¼š
```csharp
var userAgent = "YourAppName/1.0 (https://your-contact.com)";
```

### é—®é¢˜ 4: æ‰¾ä¸åˆ° key.txt

**è§£å†³æ–¹æ¡ˆ**ï¼š
ç¡®ä¿ `key.txt` åœ¨é¡¹ç›®æ ¹ç›®å½• `D:\code\Csharp\Bangumi.NET\key.txt`

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **ä»£ç æ–‡ä»¶**: 10 ä¸ª
- **ä»£ç è¡Œæ•°**: ~1500 è¡Œ
- **æ¨¡å‹ç±»**: 40+ ä¸ª
- **API æ–¹æ³•**: 27 ä¸ª
- **æ–‡æ¡£é¡µæ•°**: 7 ä¸ªæ–‡æ¡£æ–‡ä»¶
- **æ–‡æ¡£å­—æ•°**: çº¦ 2 ä¸‡å­—
- **ç¤ºä¾‹ä»£ç **: 150+ è¡Œ

## ğŸ¯ ä¸»è¦äº®ç‚¹

1. **å®Œæ•´æ€§** - 100% è¦†ç›– Bangumi API v0 æ‰€æœ‰åŠŸèƒ½
2. **æ˜“ç”¨æ€§** - ç®€å•ç›´è§‚çš„ API è®¾è®¡ï¼Œ5 åˆ†é’Ÿå³å¯ä¸Šæ‰‹
3. **ç±»å‹å®‰å…¨** - å¼ºç±»å‹å®šä¹‰ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥
4. **ç°ä»£åŒ–** - ä½¿ç”¨ .NET 8.0 å’Œæœ€æ–°çš„ C# ç‰¹æ€§
5. **æ–‡æ¡£é½å…¨** - 7 ä¸ªæ–‡æ¡£æ–‡ä»¶ï¼Œè¯¦ç»†çš„ API è¯´æ˜å’Œç¤ºä¾‹
6. **ç”Ÿäº§å°±ç»ª** - å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†

## ğŸ“ ä»£ç ç¤ºä¾‹ç²¾é€‰

### æœç´¢æ¡ç›®

```csharp
var request = new SubjectSearchRequest
{
    Keyword = "fate",
    Sort = "rank",
    Filter = new SubjectSearchFilter
    {
        Type = new List<int> { 2 }, // åŠ¨ç”»
        Rating = new List<string> { ">=8" } // è¯„åˆ† >= 8
    }
};
var result = await client.SearchSubjectsAsync(request);
```

### ç®¡ç†æ”¶è—

```csharp
// æ·»åŠ æ”¶è—
var request = new UserCollectionModifyRequest
{
    Type = (int)SubjectCollectionType.Doing, // åœ¨çœ‹
    Rate = 9, // è¯„åˆ†
    Comment = "å¾ˆå¥½çœ‹ï¼",
    Tags = new List<string> { "æ²»æ„ˆ", "æ„ŸåŠ¨" }
};
await client.UpdateUserCollectionAsync(subjectId, request);

// æ ‡è®°é›†æ•°ä¸ºçœ‹è¿‡
var batchRequest = new EpisodeCollectionBatchRequest
{
    EpisodeId = new List<int> { 1, 2, 3, 4, 5 },
    Type = (int)EpisodeCollectionType.Done
};
await client.PatchUserSubjectEpisodeCollectionAsync(subjectId, batchRequest);
```

### è·å–æ¯æ—¥æ”¾é€

```csharp
var calendar = await client.GetCalendarAsync();
foreach (var day in calendar)
{
    Console.WriteLine($"{day.Weekday?.Cn}:");
    foreach (var item in day.Items ?? new())
    {
        Console.WriteLine($"  {item.Name} - è¯„åˆ†: {item.Rating?.Score}");
    }
}
```

## ğŸ”§ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯åš

1. âœ… è¿è¡Œç¤ºä¾‹ç¨‹åºéªŒè¯åŠŸèƒ½
2. âœ… é˜…è¯»æ–‡æ¡£äº†è§£æ›´å¤šç”¨æ³•
3. âœ… åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨

### çŸ­æœŸæ”¹è¿›

1. æ·»åŠ å•å…ƒæµ‹è¯•
2. æ·»åŠ è¯·æ±‚é‡è¯•æœºåˆ¶
3. æ·»åŠ è¯·æ±‚é™æµä¿æŠ¤
4. æ·»åŠ è¯¦ç»†æ—¥å¿—

### é•¿æœŸè®¡åˆ’

1. å‘å¸ƒä¸º NuGet åŒ…
2. æ”¯æŒæ›´å¤š .NET ç‰ˆæœ¬
3. æ·»åŠ ç¼“å­˜æ”¯æŒ
4. åˆ›å»º GUI ç¤ºä¾‹åº”ç”¨

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœ‰é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼š

1. **æŸ¥çœ‹æ–‡æ¡£**
   - README.md - å®Œæ•´åŠŸèƒ½è¯´æ˜
   - EXAMPLES.md - è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹
   - VERIFICATION.md - éªŒè¯æ¸…å•

2. **è¿è¡Œç¤ºä¾‹**
   - Bangumi.NET.Example - å®Œæ•´ç¤ºä¾‹ç¨‹åº

3. **åœ¨çº¿èµ„æº**
   - Bangumi API æ–‡æ¡£: https://github.com/bangumi/api
   - è·å– API Key: https://next.bgm.tv/demo/access-token

## ğŸ‰ æ€»ç»“

Bangumi.NET æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ˜“äºä½¿ç”¨çš„ Bangumi API å®¢æˆ·ç«¯åº“ã€‚åªéœ€æä¾› API Key å’Œ User-Agentï¼Œå³å¯ç«‹å³å¼€å§‹ä½¿ç”¨æ‰€æœ‰ Bangumi API åŠŸèƒ½ï¼

**é¡¹ç›®å·²å®Œæˆï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼**

ç¥ä½¿ç”¨æ„‰å¿«ï¼ ğŸš€

---

**é¡¹ç›®å®Œæˆæ—¶é—´**: 2024
**ç‰ˆæœ¬**: 1.0.0
**æŠ€æœ¯æ ˆ**: .NET 8.0, C#, System.Text.Json
**API è¦†ç›–ç‡**: 100%
**æ–‡æ¡£å®Œæ•´æ€§**: âœ… å®Œæ•´